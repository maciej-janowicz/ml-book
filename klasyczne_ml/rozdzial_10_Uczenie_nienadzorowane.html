
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Uczenie nienadzorowane &#8212; Elementarne uczenie maszynowe</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'klasyczne_ml/rozdzial_10_Uczenie_nienadzorowane';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modele liniowe i drzewiaste" href="rozdzial_11_Modele_liniowe_i_drzewiaste.html" />
    <link rel="prev" title="Uczenie nadzorowane" href="rozdzial_09_Uczenie_nadzorowane.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Elementarne uczenie maszynowe - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Elementarne uczenie maszynowe - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../podstawy/rozdzial_01_Wst%C4%99p_do_uczenia_maszynowego.html">Wstęp do uczenia maszynowego</a></li>
<li class="toctree-l1"><a class="reference internal" href="../podstawy/rozdzial_02_Rodzaje_uczenia_maszynowego.html">Rodzaje uczenia maszynowego</a></li>
<li class="toctree-l1"><a class="reference internal" href="../podstawy/rozdzial_03_Matematyka_w_uczeniu_maszynowym.html">Matematyka w uczeniu maszynowym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../podstawy/rozdzial_04_Wst%C4%99pne_przetwarzanie_danych.html">Wstępne przetwarzanie danych</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biblioteki/rozdzial_07_TensorFlow.html">Biblioteka TensorFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biblioteki/rozdzial_08_PyTorch.html">Biblioteka Pytorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="rozdzial_09_Uczenie_nadzorowane.html">Uczenie nadzorowane</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Uczenie nienadzorowane</a></li>
<li class="toctree-l1"><a class="reference internal" href="rozdzial_11_Modele_liniowe_i_drzewiaste.html">Modele liniowe i drzewiaste</a></li>
<li class="toctree-l1"><a class="reference internal" href="rozdzial_13_Klasyfikacja_binarna_%C4%87wiczenia.html">Klasyfikacja binarna - ćwiczenia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../walidacja/rozdzial_14_Walidacja_modeli.html">Walidacja modeli</a></li>

<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_15_Sieci_CNN.html">Sieci konwolucyjne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_16_Sieci_RNN.html">Sieci rekurencyjne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_17_Sieci_LSTM.html">Sieci LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_18_Sieci_GAN.html">Sieci GAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_19_Architektury_sieci_neuronowych_1.html">Architektury sieci neuronowych, część 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../g%C5%82%C4%99bokie_ml/rozdzial_20_Transformery.html">Wstęp do transformerów</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ensembling/rozdzial_21_Ensembling.html">Metody zespołowe</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/maciej-janowicz/ml-book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/klasyczne_ml/rozdzial_10_Uczenie_nienadzorowane.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Uczenie nienadzorowane</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-k-srednich-k-means">Algorytm K-średnich (K-means)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opis-algorytmu">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-dbscan-density-based-spatial-clustering-of-applications-with-noise">Algorytm DBSCAN (Density-Based Spatial Clustering of Applications with Noise)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Opis algorytmu:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-eps">Parametr eps</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wplyw-na-wyniki">Wpływ na wyniki:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-min-samples">Parametr min_samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Wpływ na wyniki:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-hierarchicznej-klasteryzacji-hierarchical-clustering">Algorytm Hierarchicznej Klasteryzacji (Hierarchical Clustering)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#znaczenie-zmiennej-linked">Znaczenie zmiennej ‘linked’</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-single">Parametr ‘single’</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#znaczenie-parametru-single-okresla-on-metode-obliczania-odleglosci-miedzy-klastrami-w-algorytmie-hierarchicznej-klasteryzacji">Znaczenie parametru ‘single’: określa on metodę obliczania odległości między klastrami w algorytmie hierarchicznej klasteryzacji.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inne-metody-laczenia">Inne “metody łączenia”:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-gaussowskich-mieszanin-gaussian-mixture-models-gmm">Algorytm Gaussowskich Mieszanin (Gaussian Mixture Models, GMM)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-analizy-glownych-skladowych-principal-component-analysis-pca">Algorytm Analizy Głównych Składowych (Principal Component Analysis, PCA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Opis algorytmu:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uporzadkowanie-wedlug-wariancji">Uporządkowanie według wariancji:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proporcja-wyjasnionej-wariancji">“Proporcja wyjaśnionej wariancji”:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="uczenie-nienadzorowane">
<h1>Uczenie nienadzorowane<a class="headerlink" href="#uczenie-nienadzorowane" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/traitlets/config/application.py&quot;, line 1075, in launch_instance
    app.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelapp.py&quot;, line 701, in start
    self.io_loop.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/tornado/platform/asyncio.py&quot;, line 205, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 639, in run_forever
    self._run_once()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 1985, in _run_once
    handle._run()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/events.py&quot;, line 88, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 534, in dispatch_queue
    await self.process_one()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 523, in process_one
    await dispatch(*args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 429, in dispatch_shell
    await result
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 767, in execute_request
    reply_content = await reply_content
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 429, in do_execute
    res = shell.run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/zmqshell.py&quot;, line 549, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3075, in run_cell
    result = self._run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3130, in _run_cell
    result = runner(coro)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/async_helpers.py&quot;, line 128, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3334, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3517, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3577, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_16568/4234695713.py&quot;, line 2, in &lt;module&gt;
    import pandas as pd
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/__init__.py&quot;, line 26, in &lt;module&gt;
    from pandas.compat import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/compat/__init__.py&quot;, line 29, in &lt;module&gt;
    from pandas.compat.pyarrow import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/compat/pyarrow.py&quot;, line 8, in &lt;module&gt;
    import pyarrow as pa
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pyarrow/__init__.py&quot;, line 65, in &lt;module&gt;
    import pyarrow.lib as _lib
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py:44,</span> in <span class="ni">__getattr__</span><span class="nt">(attr_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="c1"># Also print the message (with traceback).  This is because old versions</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="c1"># of NumPy unfortunately set up the import to replace (and hide) the</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="c1"># error.  The traceback shouldn&#39;t be needed, but e.g. pytest plugins</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="c1"># seem to swallow it and we should be failing anyway...</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="n">tb_msg</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">44</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_multiarray_umath</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">ImportError</span>: 
<span class="n">A</span> <span class="n">module</span> <span class="n">that</span> <span class="n">was</span> <span class="n">compiled</span> <span class="n">using</span> <span class="n">NumPy</span> <span class="mf">1.</span><span class="n">x</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">run</span> <span class="ow">in</span>
<span class="n">NumPy</span> <span class="mf">2.2.6</span> <span class="k">as</span> <span class="n">it</span> <span class="n">may</span> <span class="n">crash</span><span class="o">.</span> <span class="n">To</span> <span class="n">support</span> <span class="n">both</span> <span class="mf">1.</span><span class="n">x</span> <span class="ow">and</span> <span class="mf">2.</span><span class="n">x</span>
<span class="n">versions</span> <span class="n">of</span> <span class="n">NumPy</span><span class="p">,</span> <span class="n">modules</span> <span class="n">must</span> <span class="n">be</span> <span class="n">compiled</span> <span class="k">with</span> <span class="n">NumPy</span> <span class="mf">2.0</span><span class="o">.</span>
<span class="n">Some</span> <span class="n">module</span> <span class="n">may</span> <span class="n">need</span> <span class="n">to</span> <span class="n">rebuild</span> <span class="n">instead</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">with</span> <span class="s1">&#39;pybind11&gt;=2.12&#39;</span><span class="o">.</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="n">a</span> <span class="n">user</span> <span class="n">of</span> <span class="n">the</span> <span class="n">module</span><span class="p">,</span> <span class="n">the</span> <span class="n">easiest</span> <span class="n">solution</span> <span class="n">will</span> <span class="n">be</span> <span class="n">to</span>
<span class="n">downgrade</span> <span class="n">to</span> <span class="s1">&#39;numpy&lt;2&#39;</span> <span class="ow">or</span> <span class="k">try</span> <span class="n">to</span> <span class="n">upgrade</span> <span class="n">the</span> <span class="n">affected</span> <span class="n">module</span><span class="o">.</span>
<span class="n">We</span> <span class="n">expect</span> <span class="n">that</span> <span class="n">some</span> <span class="n">modules</span> <span class="n">will</span> <span class="n">need</span> <span class="n">time</span> <span class="n">to</span> <span class="n">support</span> <span class="n">NumPy</span> <span class="mf">2.</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/traitlets/config/application.py&quot;, line 1075, in launch_instance
    app.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelapp.py&quot;, line 701, in start
    self.io_loop.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/tornado/platform/asyncio.py&quot;, line 205, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 639, in run_forever
    self._run_once()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 1985, in _run_once
    handle._run()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/events.py&quot;, line 88, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 534, in dispatch_queue
    await self.process_one()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 523, in process_one
    await dispatch(*args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 429, in dispatch_shell
    await result
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 767, in execute_request
    reply_content = await reply_content
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 429, in do_execute
    res = shell.run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/zmqshell.py&quot;, line 549, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3075, in run_cell
    result = self._run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3130, in _run_cell
    result = runner(coro)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/async_helpers.py&quot;, line 128, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3334, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3517, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3577, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_16568/4234695713.py&quot;, line 2, in &lt;module&gt;
    import pandas as pd
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/__init__.py&quot;, line 49, in &lt;module&gt;
    from pandas.core.api import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/api.py&quot;, line 9, in &lt;module&gt;
    from pandas.core.dtypes.dtypes import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/dtypes/dtypes.py&quot;, line 24, in &lt;module&gt;
    from pandas._libs import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pyarrow/__init__.py&quot;, line 65, in &lt;module&gt;
    import pyarrow.lib as _lib
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py:44,</span> in <span class="ni">__getattr__</span><span class="nt">(attr_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="c1"># Also print the message (with traceback).  This is because old versions</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="c1"># of NumPy unfortunately set up the import to replace (and hide) the</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="c1"># error.  The traceback shouldn&#39;t be needed, but e.g. pytest plugins</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="c1"># seem to swallow it and we should be failing anyway...</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="n">tb_msg</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">44</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_multiarray_umath</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">ImportError</span>: 
<span class="n">A</span> <span class="n">module</span> <span class="n">that</span> <span class="n">was</span> <span class="n">compiled</span> <span class="n">using</span> <span class="n">NumPy</span> <span class="mf">1.</span><span class="n">x</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">run</span> <span class="ow">in</span>
<span class="n">NumPy</span> <span class="mf">2.2.6</span> <span class="k">as</span> <span class="n">it</span> <span class="n">may</span> <span class="n">crash</span><span class="o">.</span> <span class="n">To</span> <span class="n">support</span> <span class="n">both</span> <span class="mf">1.</span><span class="n">x</span> <span class="ow">and</span> <span class="mf">2.</span><span class="n">x</span>
<span class="n">versions</span> <span class="n">of</span> <span class="n">NumPy</span><span class="p">,</span> <span class="n">modules</span> <span class="n">must</span> <span class="n">be</span> <span class="n">compiled</span> <span class="k">with</span> <span class="n">NumPy</span> <span class="mf">2.0</span><span class="o">.</span>
<span class="n">Some</span> <span class="n">module</span> <span class="n">may</span> <span class="n">need</span> <span class="n">to</span> <span class="n">rebuild</span> <span class="n">instead</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">with</span> <span class="s1">&#39;pybind11&gt;=2.12&#39;</span><span class="o">.</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="n">a</span> <span class="n">user</span> <span class="n">of</span> <span class="n">the</span> <span class="n">module</span><span class="p">,</span> <span class="n">the</span> <span class="n">easiest</span> <span class="n">solution</span> <span class="n">will</span> <span class="n">be</span> <span class="n">to</span>
<span class="n">downgrade</span> <span class="n">to</span> <span class="s1">&#39;numpy&lt;2&#39;</span> <span class="ow">or</span> <span class="k">try</span> <span class="n">to</span> <span class="n">upgrade</span> <span class="n">the</span> <span class="n">affected</span> <span class="n">module</span><span class="o">.</span>
<span class="n">We</span> <span class="n">expect</span> <span class="n">that</span> <span class="n">some</span> <span class="n">modules</span> <span class="n">will</span> <span class="n">need</span> <span class="n">time</span> <span class="n">to</span> <span class="n">support</span> <span class="n">NumPy</span> <span class="mf">2.</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/traitlets/config/application.py&quot;, line 1075, in launch_instance
    app.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelapp.py&quot;, line 701, in start
    self.io_loop.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/tornado/platform/asyncio.py&quot;, line 205, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 639, in run_forever
    self._run_once()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 1985, in _run_once
    handle._run()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/events.py&quot;, line 88, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 534, in dispatch_queue
    await self.process_one()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 523, in process_one
    await dispatch(*args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 429, in dispatch_shell
    await result
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 767, in execute_request
    reply_content = await reply_content
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 429, in do_execute
    res = shell.run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/zmqshell.py&quot;, line 549, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3075, in run_cell
    result = self._run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3130, in _run_cell
    result = runner(coro)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/async_helpers.py&quot;, line 128, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3334, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3517, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3577, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_16568/4234695713.py&quot;, line 2, in &lt;module&gt;
    import pandas as pd
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/__init__.py&quot;, line 49, in &lt;module&gt;
    from pandas.core.api import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/api.py&quot;, line 28, in &lt;module&gt;
    from pandas.core.arrays import Categorical
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/__init__.py&quot;, line 1, in &lt;module&gt;
    from pandas.core.arrays.arrow import ArrowExtensionArray
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/arrow/__init__.py&quot;, line 5, in &lt;module&gt;
    from pandas.core.arrays.arrow.array import ArrowExtensionArray
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/arrow/array.py&quot;, line 53, in &lt;module&gt;
    from pandas.core import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/ops/__init__.py&quot;, line 8, in &lt;module&gt;
    from pandas.core.ops.array_ops import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/ops/array_ops.py&quot;, line 56, in &lt;module&gt;
    from pandas.core.computation import expressions
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/computation/expressions.py&quot;, line 21, in &lt;module&gt;
    from pandas.core.computation.check import NUMEXPR_INSTALLED
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/computation/check.py&quot;, line 5, in &lt;module&gt;
    ne = import_optional_dependency(&quot;numexpr&quot;, errors=&quot;warn&quot;)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/compat/_optional.py&quot;, line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File &quot;/home/maciej/anaconda3/lib/python3.12/importlib/__init__.py&quot;, line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/numexpr/__init__.py&quot;, line 24, in &lt;module&gt;
    from numexpr.interpreter import MAX_THREADS, use_vml, __BLOCK_SIZE1__
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="ne">AttributeError</span>: _ARRAY_API not found
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/traitlets/config/application.py&quot;, line 1075, in launch_instance
    app.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelapp.py&quot;, line 701, in start
    self.io_loop.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/tornado/platform/asyncio.py&quot;, line 205, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 639, in run_forever
    self._run_once()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 1985, in _run_once
    handle._run()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/events.py&quot;, line 88, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 534, in dispatch_queue
    await self.process_one()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 523, in process_one
    await dispatch(*args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 429, in dispatch_shell
    await result
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 767, in execute_request
    reply_content = await reply_content
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 429, in do_execute
    res = shell.run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/zmqshell.py&quot;, line 549, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3075, in run_cell
    result = self._run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3130, in _run_cell
    result = runner(coro)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/async_helpers.py&quot;, line 128, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3334, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3517, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3577, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_16568/4234695713.py&quot;, line 2, in &lt;module&gt;
    import pandas as pd
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/__init__.py&quot;, line 49, in &lt;module&gt;
    from pandas.core.api import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/api.py&quot;, line 28, in &lt;module&gt;
    from pandas.core.arrays import Categorical
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/__init__.py&quot;, line 1, in &lt;module&gt;
    from pandas.core.arrays.arrow import ArrowExtensionArray
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/arrow/__init__.py&quot;, line 5, in &lt;module&gt;
    from pandas.core.arrays.arrow.array import ArrowExtensionArray
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/arrow/array.py&quot;, line 67, in &lt;module&gt;
    from pandas.core.arrays.masked import BaseMaskedArray
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/arrays/masked.py&quot;, line 61, in &lt;module&gt;
    from pandas.core import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/core/nanops.py&quot;, line 52, in &lt;module&gt;
    bn = import_optional_dependency(&quot;bottleneck&quot;, errors=&quot;warn&quot;)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/pandas/compat/_optional.py&quot;, line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File &quot;/home/maciej/anaconda3/lib/python3.12/importlib/__init__.py&quot;, line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/bottleneck/__init__.py&quot;, line 7, in &lt;module&gt;
    from .move import (move_argmax, move_argmin, move_max, move_mean, move_median,
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py:44,</span> in <span class="ni">__getattr__</span><span class="nt">(attr_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="c1"># Also print the message (with traceback).  This is because old versions</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="c1"># of NumPy unfortunately set up the import to replace (and hide) the</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="c1"># error.  The traceback shouldn&#39;t be needed, but e.g. pytest plugins</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="c1"># seem to swallow it and we should be failing anyway...</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="n">tb_msg</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">44</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_multiarray_umath</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">ImportError</span>: 
<span class="n">A</span> <span class="n">module</span> <span class="n">that</span> <span class="n">was</span> <span class="n">compiled</span> <span class="n">using</span> <span class="n">NumPy</span> <span class="mf">1.</span><span class="n">x</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">run</span> <span class="ow">in</span>
<span class="n">NumPy</span> <span class="mf">2.2.6</span> <span class="k">as</span> <span class="n">it</span> <span class="n">may</span> <span class="n">crash</span><span class="o">.</span> <span class="n">To</span> <span class="n">support</span> <span class="n">both</span> <span class="mf">1.</span><span class="n">x</span> <span class="ow">and</span> <span class="mf">2.</span><span class="n">x</span>
<span class="n">versions</span> <span class="n">of</span> <span class="n">NumPy</span><span class="p">,</span> <span class="n">modules</span> <span class="n">must</span> <span class="n">be</span> <span class="n">compiled</span> <span class="k">with</span> <span class="n">NumPy</span> <span class="mf">2.0</span><span class="o">.</span>
<span class="n">Some</span> <span class="n">module</span> <span class="n">may</span> <span class="n">need</span> <span class="n">to</span> <span class="n">rebuild</span> <span class="n">instead</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">with</span> <span class="s1">&#39;pybind11&gt;=2.12&#39;</span><span class="o">.</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="n">a</span> <span class="n">user</span> <span class="n">of</span> <span class="n">the</span> <span class="n">module</span><span class="p">,</span> <span class="n">the</span> <span class="n">easiest</span> <span class="n">solution</span> <span class="n">will</span> <span class="n">be</span> <span class="n">to</span>
<span class="n">downgrade</span> <span class="n">to</span> <span class="s1">&#39;numpy&lt;2&#39;</span> <span class="ow">or</span> <span class="k">try</span> <span class="n">to</span> <span class="n">upgrade</span> <span class="n">the</span> <span class="n">affected</span> <span class="n">module</span><span class="o">.</span>
<span class="n">We</span> <span class="n">expect</span> <span class="n">that</span> <span class="n">some</span> <span class="n">modules</span> <span class="n">will</span> <span class="n">need</span> <span class="n">time</span> <span class="n">to</span> <span class="n">support</span> <span class="n">NumPy</span> <span class="mf">2.</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.2.6 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel_launcher.py&quot;, line 17, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/traitlets/config/application.py&quot;, line 1075, in launch_instance
    app.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelapp.py&quot;, line 701, in start
    self.io_loop.start()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/tornado/platform/asyncio.py&quot;, line 205, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 639, in run_forever
    self._run_once()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/base_events.py&quot;, line 1985, in _run_once
    handle._run()
  File &quot;/home/maciej/anaconda3/lib/python3.12/asyncio/events.py&quot;, line 88, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 534, in dispatch_queue
    await self.process_one()
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 523, in process_one
    await dispatch(*args)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 429, in dispatch_shell
    await result
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/kernelbase.py&quot;, line 767, in execute_request
    reply_content = await reply_content
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 429, in do_execute
    res = shell.run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/ipykernel/zmqshell.py&quot;, line 549, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3075, in run_cell
    result = self._run_cell(
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3130, in _run_cell
    result = runner(coro)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/async_helpers.py&quot;, line 128, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3334, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3517, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/IPython/core/interactiveshell.py&quot;, line 3577, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_16568/4234695713.py&quot;, line 3, in &lt;module&gt;
    import matplotlib.pyplot as plt
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/__init__.py&quot;, line 159, in &lt;module&gt;
    from . import _api, _version, cbook, _docstring, rcsetup
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/rcsetup.py&quot;, line 28, in &lt;module&gt;
    from matplotlib.colors import Colormap, is_color_like
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/colors.py&quot;, line 57, in &lt;module&gt;
    from matplotlib import _api, _cm, cbook, scale
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/scale.py&quot;, line 22, in &lt;module&gt;
    from matplotlib.ticker import (
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/ticker.py&quot;, line 144, in &lt;module&gt;
    from matplotlib import transforms as mtransforms
  File &quot;/home/maciej/anaconda3/lib/python3.12/site-packages/matplotlib/transforms.py&quot;, line 49, in &lt;module&gt;
    from matplotlib._path import (
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py:44,</span> in <span class="ni">__getattr__</span><span class="nt">(attr_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="c1"># Also print the message (with traceback).  This is because old versions</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span>     <span class="c1"># of NumPy unfortunately set up the import to replace (and hide) the</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="c1"># error.  The traceback shouldn&#39;t be needed, but e.g. pytest plugins</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="c1"># seem to swallow it and we should be failing anyway...</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="n">tb_msg</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">44</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_multiarray_umath</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">ImportError</span>: 
<span class="n">A</span> <span class="n">module</span> <span class="n">that</span> <span class="n">was</span> <span class="n">compiled</span> <span class="n">using</span> <span class="n">NumPy</span> <span class="mf">1.</span><span class="n">x</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">run</span> <span class="ow">in</span>
<span class="n">NumPy</span> <span class="mf">2.2.6</span> <span class="k">as</span> <span class="n">it</span> <span class="n">may</span> <span class="n">crash</span><span class="o">.</span> <span class="n">To</span> <span class="n">support</span> <span class="n">both</span> <span class="mf">1.</span><span class="n">x</span> <span class="ow">and</span> <span class="mf">2.</span><span class="n">x</span>
<span class="n">versions</span> <span class="n">of</span> <span class="n">NumPy</span><span class="p">,</span> <span class="n">modules</span> <span class="n">must</span> <span class="n">be</span> <span class="n">compiled</span> <span class="k">with</span> <span class="n">NumPy</span> <span class="mf">2.0</span><span class="o">.</span>
<span class="n">Some</span> <span class="n">module</span> <span class="n">may</span> <span class="n">need</span> <span class="n">to</span> <span class="n">rebuild</span> <span class="n">instead</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">with</span> <span class="s1">&#39;pybind11&gt;=2.12&#39;</span><span class="o">.</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="n">a</span> <span class="n">user</span> <span class="n">of</span> <span class="n">the</span> <span class="n">module</span><span class="p">,</span> <span class="n">the</span> <span class="n">easiest</span> <span class="n">solution</span> <span class="n">will</span> <span class="n">be</span> <span class="n">to</span>
<span class="n">downgrade</span> <span class="n">to</span> <span class="s1">&#39;numpy&lt;2&#39;</span> <span class="ow">or</span> <span class="k">try</span> <span class="n">to</span> <span class="n">upgrade</span> <span class="n">the</span> <span class="n">affected</span> <span class="n">module</span><span class="o">.</span>
<span class="n">We</span> <span class="n">expect</span> <span class="n">that</span> <span class="n">some</span> <span class="n">modules</span> <span class="n">will</span> <span class="n">need</span> <span class="n">time</span> <span class="n">to</span> <span class="n">support</span> <span class="n">NumPy</span> <span class="mf">2.</span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="ne">ImportError</span>: numpy.core.multiarray failed to import

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">159</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span> <span class="kn">from</span> <span class="nn">packaging.version</span> <span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">parse_version</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span> <span class="c1"># cbook must import matplotlib only within function</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span> <span class="c1"># definitions, so it is safe to import from it here.</span>
<span class="ne">--&gt; </span><span class="mi">159</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_version</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">_docstring</span><span class="p">,</span> <span class="n">rcsetup</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span> <span class="kn">from</span> <span class="nn">matplotlib.cbook</span> <span class="kn">import</span> <span class="n">sanitize_sequence</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span> <span class="kn">from</span> <span class="nn">matplotlib._api</span> <span class="kn">import</span> <span class="n">MatplotlibDeprecationWarning</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">rcsetup</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">28</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span> <span class="nn">matplotlib.backends</span> <span class="kn">import</span> <span class="n">BackendFilter</span><span class="p">,</span> <span class="n">backend_registry</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="kn">from</span> <span class="nn">matplotlib.cbook</span> <span class="kn">import</span> <span class="n">ls_mapper</span>
<span class="ne">---&gt; </span><span class="mi">28</span> <span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Colormap</span><span class="p">,</span> <span class="n">is_color_like</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="kn">from</span> <span class="nn">matplotlib._fontconfig_pattern</span> <span class="kn">import</span> <span class="n">parse_fontconfig_pattern</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="kn">from</span> <span class="nn">matplotlib._enums</span> <span class="kn">import</span> <span class="n">JoinStyle</span><span class="p">,</span> <span class="n">CapStyle</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">colors</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">57</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">---&gt; </span><span class="mi">57</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_cm</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">scale</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="kn">from</span> <span class="nn">._color_data</span> <span class="kn">import</span> <span class="n">BASE_COLORS</span><span class="p">,</span> <span class="n">TABLEAU_COLORS</span><span class="p">,</span> <span class="n">CSS4_COLORS</span><span class="p">,</span> <span class="n">XKCD_COLORS</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="k">class</span> <span class="nc">_ColorMapping</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">scale</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">22</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_docstring</span>
<span class="ne">---&gt; </span><span class="mi">22</span> <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span>     <span class="n">NullFormatter</span><span class="p">,</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">LogFormatterSciNotation</span><span class="p">,</span> <span class="n">LogitFormatter</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">NullLocator</span><span class="p">,</span> <span class="n">LogLocator</span><span class="p">,</span> <span class="n">AutoLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="n">SymmetricalLogLocator</span><span class="p">,</span> <span class="n">AsinhLocator</span><span class="p">,</span> <span class="n">LogitLocator</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Transform</span><span class="p">,</span> <span class="n">IdentityTransform</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="k">class</span> <span class="nc">ScaleBase</span><span class="p">:</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">ticker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">144</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span>
<span class="ne">--&gt; </span><span class="mi">144</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">transforms</span> <span class="k">as</span> <span class="n">mtransforms</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span> <span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;TickHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FixedFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>            <span class="s1">&#39;NullFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FuncFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FormatStrFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>            <span class="s1">&#39;StrMethodFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;ScalarFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;LogFormatter&#39;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>            <span class="s1">&#39;MultipleLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;MaxNLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoMinorLocator&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>            <span class="s1">&#39;SymmetricalLogLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AsinhLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;LogitLocator&#39;</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.12</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">transforms</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">49</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">_api</span>
<span class="ne">---&gt; </span><span class="mi">49</span> <span class="kn">from</span> <span class="nn">matplotlib._path</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="n">affine_transform</span><span class="p">,</span> <span class="n">count_bboxes_overlapping_bbox</span><span class="p">,</span> <span class="n">update_path_extents</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> <span class="kn">from</span> <span class="nn">.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>

<span class="ne">ImportError</span>: initialization failed
</pre></div>
</div>
</div>
</div>
<section id="algorytm-k-srednich-k-means">
<h2>Algorytm K-średnich (K-means)<a class="headerlink" href="#algorytm-k-srednich-k-means" title="Link to this heading">#</a></h2>
<section id="opis-algorytmu">
<h3>Opis algorytmu:<a class="headerlink" href="#opis-algorytmu" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Algorytm K-średnich jest metodą klasteryzacji, która dzieli dane na K klastrów.</p></li>
<li><p>Każdy punkt danych jest przypisywany do najbliższego tzw. centroidu, reprezentującego cały klaster.</p></li>
<li><p>Centroidy są aktualizowane jako (swego rodzaju) średnie punktów w klastrze.</p></li>
<li><p>Proces powtarza się do momentu, gdy położenia centroidów ustabilizują się.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generowanie danych</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Wykorzystanie algorytmu K-średnich</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Wyniki</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Centroidy:&quot;</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Przypisania klastrów:&quot;</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="c1"># Wizualizacja</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Centroidy: [[4.   1.  ]
 [1.75 2.5 ]]
Przypisania klastrów: [1 1 1 0 1 0]
</pre></div>
</div>
<img alt="../_images/e5c0cdd92cae11bf1726b53329fef37d48a930b3572a21adb5b7fb9d1b459513.png" src="../_images/e5c0cdd92cae11bf1726b53329fef37d48a930b3572a21adb5b7fb9d1b459513.png" />
</div>
</div>
</section>
</section>
<section id="algorytm-dbscan-density-based-spatial-clustering-of-applications-with-noise">
<h2>Algorytm DBSCAN (Density-Based Spatial Clustering of Applications with Noise)<a class="headerlink" href="#algorytm-dbscan-density-based-spatial-clustering-of-applications-with-noise" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Opis algorytmu:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>DBSCAN jest algorytmem klasteryzacji opartym na gęstości.</p></li>
<li><p>Oznacza to, że poszczególne punkty są grupowane na podstawie gęstości (innych) punktów w ich otoczeniu.</p></li>
<li><p>Punkty, które nie należą do żadnego klastra, są traktowane jako szum.</p></li>
<li><p>Algorytm nie wymaga z góry określonej liczby klastrów.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">DBSCAN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generowanie danych</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">80</span><span class="p">]])</span>

<span class="c1"># Wykorzystanie algorytmu DBSCAN</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Wyniki</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Liczba klastrów:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">labels_</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">labels_</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Etykiety klastrów:&quot;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="c1"># Wizualizacja</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Liczba klastrów: 2
Etykiety klastrów: [ 0  0  0  1  1 -1]
</pre></div>
</div>
<img alt="../_images/d79a356bbeb590231f6206826c12979b73616aad3a91eac3378aa54a988060d6.png" src="../_images/d79a356bbeb590231f6206826c12979b73616aad3a91eac3378aa54a988060d6.png" />
</div>
</div>
</section>
<section id="parametr-eps">
<h3>Parametr eps<a class="headerlink" href="#parametr-eps" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Znaczenie: <span class="math notranslate nohighlight">\(eps\)</span> (epsilon) określa maksymalną odległość między dwoma punktami, aby mogły jeszcze być uznane za sąsiadów.</p></li>
<li><p>Inaczej mówiąc, jest to promień sfery (w przestrzeni wielowymiarowej) wokół każdego punktu, w której algorytm szuka sąsiadów.</p></li>
</ul>
<section id="wplyw-na-wyniki">
<h4>Wpływ na wyniki:<a class="headerlink" href="#wplyw-na-wyniki" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Jeśli eps jest zbyt małe, algorytm może nie znaleźć wystarczającej liczby sąsiadów, co może prowadzić do wielu małych klastrów lub dużej liczby punktów uznanych za szum.</p></li>
<li><p>Jeśli eps jest zbyt duże, algorytm może łączyć punkty, które nie powinny być w tym samym klastrze, co może prowadzić do zbyt dużych klastrów.</p></li>
</ul>
</section>
</section>
<section id="parametr-min-samples">
<h3>Parametr min_samples<a class="headerlink" href="#parametr-min-samples" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Znaczenie: min_samples określa minimalną liczbę punktów, które muszą znajdować się w promieniu eps, aby punkt był uznany za punkt rdzeniowy (core point).</p></li>
<li><p>Punkty rdzeniowe są tymi, które mają wystarczającą liczbę sąsiadów, aby utworzyć wokół nich klaster.</p></li>
</ul>
<section id="id2">
<h4>Wpływ na wyniki:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Jeśli min_samples jest zbyt małe, algorytm może uznawać za punkty rdzeniowe punkty, które nie powinny być rdzeniowe, co może prowadzić do tworzenia zbyt dużych klastrów.</p></li>
<li><p>Jeśli min_samples jest zbyt duże, algorytm może nie znaleźć wystarczającej liczby punktów rdzeniowych, co może prowadzić do wielu małych klastrów lub dużej liczby punktów uznanych za szum.</p></li>
</ul>
</section>
</section>
</section>
<section id="algorytm-hierarchicznej-klasteryzacji-hierarchical-clustering">
<h2>Algorytm Hierarchicznej Klasteryzacji (Hierarchical Clustering)<a class="headerlink" href="#algorytm-hierarchicznej-klasteryzacji-hierarchical-clustering" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Opis algorytmu:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Hierarchiczna klasteryzacja tworzy drzewo klastrów.</p></li>
<li><p>Punkty są łączone w klastry na podstawie odległości między nimi.</p></li>
<li><p>Można używać różnych metryk odległości (np. euklidesowej).</p></li>
<li><p>Wynikiem jest dendrogram, który pokazuje hierarchię klastrów.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Generowanie danych</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Wykorzystanie hierarchicznej klasteryzacji</span>
<span class="n">linked</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">)</span>

<span class="c1"># Wizualizacja dendrogramu</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">linked</span><span class="p">,</span>
           <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
           <span class="n">distance_sort</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span><span class="p">,</span>
           <span class="n">show_leaf_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d72287d11bd4809955f6d3268410aae11139002041cae1d05bb4e3db92a1c7c7.png" src="../_images/d72287d11bd4809955f6d3268410aae11139002041cae1d05bb4e3db92a1c7c7.png" />
</div>
</div>
</section>
</section>
<section id="znaczenie-zmiennej-linked">
<h2>Znaczenie zmiennej ‘linked’<a class="headerlink" href="#znaczenie-zmiennej-linked" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Zmienna linked jest wynikiem funkcji linkage z biblioteki scipy.cluster.hierarchy.</p></li>
<li><p>Zawiera ona macierz łączeń (linkage matrix), która opisuje, jak punkty są łączone w klastry w kolejnych krokach algorytmu.</p></li>
<li><p>Każdy wiersz macierzy łączeń reprezentuje połączenie dwóch klastrów (lub punktów) i zawiera następujące informacje:</p></li>
<li><p>Indeksy klastrów (lub punktów) połączonych w danym kroku.</p></li>
<li><p>Odległości między połączonymi klastrami (lub punktami).</p></li>
<li><p>Liczbę elementów w nowo utworzonym klastrze.</p></li>
</ul>
</section>
<section id="parametr-single">
<h2>Parametr ‘single’<a class="headerlink" href="#parametr-single" title="Link to this heading">#</a></h2>
<section id="znaczenie-parametru-single-okresla-on-metode-obliczania-odleglosci-miedzy-klastrami-w-algorytmie-hierarchicznej-klasteryzacji">
<h3>Znaczenie parametru ‘single’: określa on metodę obliczania odległości między klastrami w algorytmie hierarchicznej klasteryzacji.<a class="headerlink" href="#znaczenie-parametru-single-okresla-on-metode-obliczania-odleglosci-miedzy-klastrami-w-algorytmie-hierarchicznej-klasteryzacji" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Jest to jedna z “metod łączenia” (linkage methods), które decydują, jak obliczać odległość między nowo utworzonym klasterem a innymi klastrami.</p></li>
<li><p>Metoda ‘single’ (pojedyncze łączenie) oblicza odległość jako minimalną odległość między punktami w różnych klastrach.</p></li>
<li><p>Inaczej mówiąc, jest to odległość między najbliższymi sobie punktami w dwóch różnych klastrach.</p></li>
</ul>
</section>
<section id="inne-metody-laczenia">
<h3>Inne “metody łączenia”:<a class="headerlink" href="#inne-metody-laczenia" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>‘complete’: Odległość między najdalszymi punktami w dwóch klastrach.</p></li>
<li><p>‘average’: Średnia odległość między wszystkimi punktami w dwóch klastrach.</p></li>
<li><p>‘centroid’: Odległość między centroidami dwóch klastrów.</p></li>
<li><p>‘median’: Odległość między medianami dwóch klastrów.</p></li>
<li><p>‘ward’: Metoda minimalizująca sumę kwadratów odległości między punktami w klastrach.</p></li>
</ul>
</section>
</section>
<section id="algorytm-gaussowskich-mieszanin-gaussian-mixture-models-gmm">
<h2>Algorytm Gaussowskich Mieszanin (Gaussian Mixture Models, GMM)<a class="headerlink" href="#algorytm-gaussowskich-mieszanin-gaussian-mixture-models-gmm" title="Link to this heading">#</a></h2>
<section id="id4">
<h3>Opis algorytmu:<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>GMM jest modelem probabilistycznym, który zakłada, że dane pochodzą z mieszaniny kilku rozkładów Gaussa.</p></li>
<li><p>Każdy klaster jest reprezentowany przez rozkład Gaussa.</p></li>
<li><p>Algorytm używa tzw. metody EM (“Expectation-Maximization”) do dopasowania modelu.</p></li>
<li><p>Wynikiem są parametry rozkładów Gaussa dla każdego klastra.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generowanie danych</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Wykorzystanie algorytmu GMM</span>
<span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Wyniki</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Średnie:&quot;</span><span class="p">,</span> <span class="n">gmm</span><span class="o">.</span><span class="n">means_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Etykiety klastrów:&quot;</span><span class="p">,</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="c1"># Wizualizacja</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Średnie: [[2.5        4.        ]
 [2.5        1.00003334]]
Etykiety klastrów: [1 0 1 1 0 1]
</pre></div>
</div>
<img alt="../_images/47ad5e8402f4a9cabf8dc457e5d98b4dc881051da0cd173f271819244446d55a.png" src="../_images/47ad5e8402f4a9cabf8dc457e5d98b4dc881051da0cd173f271819244446d55a.png" />
</div>
</div>
</section>
</section>
<section id="algorytm-analizy-glownych-skladowych-principal-component-analysis-pca">
<h2>Algorytm Analizy Głównych Składowych (Principal Component Analysis, PCA)<a class="headerlink" href="#algorytm-analizy-glownych-skladowych-principal-component-analysis-pca" title="Link to this heading">#</a></h2>
<section id="id5">
<h3>Opis algorytmu:<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>PCA jest techniką redukcji wymiarowości.</p></li>
<li><p>Transformuje dane do nowej przestrzeni, gdzie nowe osie (składowe główne) są liniowymi kombinacjami oryginalnych zmiennych.</p></li>
<li><p>Składowe główne są uporządkowane według wariancji.</p></li>
<li><p>Używany do wizualizacji i redukcji zbędnych wymiarów.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generowanie danych</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>

<span class="c1"># Wykorzystanie algorytmu PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Wyniki</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Składowe główne:&quot;</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wariancja wyjaśniona:&quot;</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>

<span class="c1"># Wizualizacja</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PCA 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PCA 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Składowe główne: [[ 0.6778734   0.73517866]
 [ 0.73517866 -0.6778734 ]]
Wariancja wyjaśniona: [0.96318131 0.03681869]
</pre></div>
</div>
<img alt="../_images/0def6ecf9030d715393929ec446c3c322e5d95276f30186e7d610eacf9c6b018.png" src="../_images/0def6ecf9030d715393929ec446c3c322e5d95276f30186e7d610eacf9c6b018.png" />
</div>
</div>
</section>
<section id="uporzadkowanie-wedlug-wariancji">
<h3>Uporządkowanie według wariancji:<a class="headerlink" href="#uporzadkowanie-wedlug-wariancji" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Pierwsza składowa główna (PC1) jest taką liniową kombinacją oryginalnych zmiennych, która maksymalizuje wariancję danych. Inaczej mówiąc, PC1 jest taką oś, wzdłuż której dane są najbardziej rozproszone.</p></li>
<li><p>Druga składowa główna (PC2) jest taką liniową kombinacją oryginalnych zmiennych, która maksymalizuje wariancję danych, ale jest ortogonalna (prostopadła) do PC1.</p></li>
<li><p>Trzecia składowa główna (PC3) jest taką liniową kombinacją oryginalnych zmiennych, która maksymalizuje wariancję danych, ale jest ortogonalna do PC1 i PC2.</p></li>
<li><p>Proces ten kontynuowany jest dla kolejnych składowych głównych, aż do wyczerpania wszystkich wymiarów danych.</p></li>
</ul>
<p>###Co zawiera pca.explained_variance_ratio_?</p>
</section>
<section id="proporcja-wyjasnionej-wariancji">
<h3>“Proporcja wyjaśnionej wariancji”:<a class="headerlink" href="#proporcja-wyjasnionej-wariancji" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Atrybut ‘pca.explained_variance_ratio_’ jest tablicą, która zawiera proporcję wariancji wyjaśnionej przez każdą składową główną.</p></li>
<li><p>Każdy element tej tablicy reprezentuje ułamek całkowitej wariancji danych, który jest wyjaśniony przez daną składową główną.</p></li>
<li><p>Suma proporcji:</p></li>
<li><p>Suma wszystkich elementów w pca.explained_variance_ratio_ jest równa 1 (lub 100%, jeśli wyrażona w procentach), co oznacza, że cała wariancja danych jest wyjaśniona przez wszystkie składowe główne razem.</p></li>
<li><p>Interpretacja:</p></li>
<li><p>Wartości w pca.explained_variance_ratio_ pozwalają ocenić, ile informacji (wariancji) jest zawarte w każdej składowej głównej.</p></li>
<li><p>Im wyższa wartość dla danej składowej głównej, tym więcej informacji ta składowa główna zawiera.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./klasyczne_ml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="rozdzial_09_Uczenie_nadzorowane.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Uczenie nadzorowane</p>
      </div>
    </a>
    <a class="right-next"
       href="rozdzial_11_Modele_liniowe_i_drzewiaste.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modele liniowe i drzewiaste</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-k-srednich-k-means">Algorytm K-średnich (K-means)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opis-algorytmu">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-dbscan-density-based-spatial-clustering-of-applications-with-noise">Algorytm DBSCAN (Density-Based Spatial Clustering of Applications with Noise)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Opis algorytmu:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-eps">Parametr eps</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wplyw-na-wyniki">Wpływ na wyniki:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-min-samples">Parametr min_samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Wpływ na wyniki:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-hierarchicznej-klasteryzacji-hierarchical-clustering">Algorytm Hierarchicznej Klasteryzacji (Hierarchical Clustering)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#znaczenie-zmiennej-linked">Znaczenie zmiennej ‘linked’</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametr-single">Parametr ‘single’</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#znaczenie-parametru-single-okresla-on-metode-obliczania-odleglosci-miedzy-klastrami-w-algorytmie-hierarchicznej-klasteryzacji">Znaczenie parametru ‘single’: określa on metodę obliczania odległości między klastrami w algorytmie hierarchicznej klasteryzacji.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inne-metody-laczenia">Inne “metody łączenia”:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-gaussowskich-mieszanin-gaussian-mixture-models-gmm">Algorytm Gaussowskich Mieszanin (Gaussian Mixture Models, GMM)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Opis algorytmu:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorytm-analizy-glownych-skladowych-principal-component-analysis-pca">Algorytm Analizy Głównych Składowych (Principal Component Analysis, PCA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Opis algorytmu:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uporzadkowanie-wedlug-wariancji">Uporządkowanie według wariancji:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proporcja-wyjasnionej-wariancji">“Proporcja wyjaśnionej wariancji”:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Maciej Janowicz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>